Database Queries - Login Flow

1. Get User by Email
LINQ Query (C#):
return await _context.Users
   .FirstOrDefaultAsync(u => u.Email.ToLower() == normalizedEmail);

SQL Query (Generated by EF Core):
SELECT TOP(1)
    [u].[UserID],
    [u].[Email],
    [u].[FullName],
    [u].[PasswordHash],
    [u].[Phone],
    [u].[Role],
    [u].[CreatedAt],
    [u].[UpdatedAt],
    [u].[WalletBalance]
FROM [User] AS [u]
WHERE LOWER([u].[Email]) = @__normalizedEmail_0

2. Password Verification
LINQ Query (C#):
return BCrypt.Net.BCrypt.Verify(password, hashedPassword);

SQL Query (Generated by EF Core):
No SQL query - password verification is done in application layer

3. JWT Token Generation
LINQ Query (C#):
No LINQ query - JWT generation is done in application layer

SQL Query (Generated by EF Core):
No SQL query - JWT generation is done in application layer

Summary:
Login flow sử dụng 1 database operation chính:
1. Get User by Email: Lấy thông tin user theo email để verify password

Password verification và JWT generation được thực hiện ở application layer, không cần database queries.

Tất cả queries đều sử dụng parameterized queries để tránh SQL injection.
