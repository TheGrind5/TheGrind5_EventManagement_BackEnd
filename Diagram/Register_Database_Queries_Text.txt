Database Queries - Register Flow

1. Email Validation
LINQ Query (C#):
return await _context.Users.AnyAsync(u => u.Email.ToLower() == normalizedEmail);

SQL Query (Generated by EF Core):
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE LOWER([u].[Email]) = @__normalizedEmail_0

2. User Creation
LINQ Query (C#):
_context.Users.Add(user);
await _context.SaveChangesAsync();

SQL Query (Generated by EF Core):
INSERT INTO [Users] (
    [Username], [FullName], [Email], [PasswordHash], [Phone], 
    [Role], [CreatedAt], [Avatar], [DateOfBirth], [Gender], [WalletBalance]
)
VALUES (
    @username, @fullName, @email, @passwordHash, @phone, 
    @role, @createdAt, @avatar, @dateOfBirth, @gender, @walletBalance
);
SELECT [UserId] FROM [Users] WHERE @@ROWCOUNT = 1 AND [UserId] = scope_identity();

3. User Retrieval
LINQ Query (C#):
return await _context.Users.FindAsync(userId);

SQL Query (Generated by EF Core):
SELECT TOP(1)
    [u].[UserId], [u].[Username], [u].[FullName], [u].[Email],
    [u].[PasswordHash], [u].[Phone], [u].[Role], [u].[CreatedAt],
    [u].[UpdatedAt], [u].[Avatar], [u].[DateOfBirth], [u].[Gender],
    [u].[WalletBalance]
FROM [Users] AS [u]
WHERE [u].[UserId] = @__userId_0

Summary:
Register flow sử dụng 3 database operations chính:
1. Email Validation: Kiểm tra email đã tồn tại
2. User Creation: Tạo user mới với default values
3. User Retrieval: Lấy thông tin user đã tạo

Tất cả queries đều sử dụng parameterized queries để tránh SQL injection.
